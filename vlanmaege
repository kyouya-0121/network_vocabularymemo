Add-Type -AssemblyName System.Windows.Forms

# フォーム作成
$form = New-Object System.Windows.Forms.Form
$form.Text = "VLAN抽出"
$form.Size = New-Object System.Drawing.Size(300,150)
$form.StartPosition = "CenterScreen"

# ラベル
$label = New-Object System.Windows.Forms.Label
$label.Text = "抽出したい VLAN ID を入力してください"
$label.AutoSize = $true
$label.Location = New-Object System.Drawing.Point(10,20)
$form.Controls.Add($label)

# テキストボックス
$textBox = New-Object System.Windows.Forms.TextBox
$textBox.Location = New-Object System.Drawing.Point(10,50)
$textBox.Width = 260
$form.Controls.Add($textBox)

# OKボタン
$okButton = New-Object System.Windows.Forms.Button
$okButton.Text = "OK"
$okButton.Location = New-Object System.Drawing.Point(100,80)
$okButton.Add_Click({ $form.Tag = $textBox.Text; $form.Close() })
$form.Controls.Add($okButton)

# フォーム表示
$form.ShowDialog() | Out-Null

# 入力取得
$VLANid = $form.Tag
if ([string]::IsNullOrWhiteSpace($VLANid)) {
    Write-Host "VLAN ID が入力されませんでした。処理を終了します。"
    exit
}

Write-Host "入力 VLAN ID: $VLANid"
